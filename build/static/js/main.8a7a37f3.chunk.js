(this.webpackJsonpAmazon_Chime_Meeting=this.webpackJsonpAmazon_Chime_Meeting||[]).push([[0],{27:function(e,t,a){e.exports=a(48)},45:function(e,t){},46:function(e,t){},47:function(e,t){},48:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),o=a(8),r=a.n(o),c=a(5),d=a(9),s=a(23),l=a(4),u=a.n(l),h=u.a.mark(f);function f(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),h)}var g={counter:0,baseURL:"",roomID:"",userName:"",userAttendeeId:"",userBaseAttendeeId:"",region:"",joinInfo:null,meetingSessionConf:null,meetingSession:null,inputAudioDevices:null,inputVideoDevices:null,inputVideoResolutions:["360p","540p","720p"],outputAudioDevices:null,selectedInputAudioDevice:"none",selectedInputVideoResolution:"none",selectedInputVideoDevice:"none",selectedOutputAudioDevice:"none",storeRoster:{}},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0,a=Object.assign({},e);return a.counter++,console.log(e,t),a},p=a(50),m=Object(p.a)({INITIALIZE:function(e){return e}}),V=a(25),w=a(21),R=a(22),k=a(26),b=a(24),C=a(10),y=a(16),I=function(){var e=Object(y.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=navigator.mediaDevices.getUserMedia({audio:!1,video:{width:{ideal:1280},height:{ideal:720}}}),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(e){Object(k.a)(a,e);var t=Object(b.a)(a);function a(){var e;Object(w.a)(this,a);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).localVideoRef=n.createRef(),e.localVideoCanvasRef=n.createRef(),e.localVideoMaskCanvasRef=n.createRef(),e.localVideoMaskCanvasRef2=n.createRef(),e.shareVideoRef=n.createRef(),e.shareVideoRef2=n.createRef(),e.localVideoMaskBackgroundRef=n.createRef(),e.localVideoMaskBGCanvasRef=n.createRef(),e.bodyPix=null,e.state={localVideoWidth:0,localVideoHeight:0,inputVideoStream:null,virtualBackground:"/resources/vbg/pic1.jpg"},e.drawVideoCanvas=function(){e.props;var t=e.bodyPix,a=(e.props,e.localVideoRef.current),n=e.localVideoCanvasRef.current,i=e.localVideoMaskCanvasRef.current,o=e.localVideoMaskCanvasRef2.current,r=e.localVideoMaskBackgroundRef.current,c=e.localVideoMaskBGCanvasRef.current;n.width=640,n.height=e.localVideoCanvasRef.current.width/16*9,n.getContext("2d").drawImage(a,0,0,n.width,n.height),t.segmentPerson(n).then((function(t){var a=C.c(t,{r:0,g:0,b:0,a:0},{r:255,g:255,b:255,a:255});C.a(i,n,a,1,2,!1);var d=i.getContext("2d").getImageData(0,0,i.width,i.height);r.src=e.state.virtualBackground,c.width=d.width,c.height=d.height;var s=c.getContext("2d");s.drawImage(r,0,0,c.width,c.height);for(var l=s.getImageData(0,0,c.width,c.height),u=new Uint8ClampedArray(d.width*d.height*4),h=0;h<d.height;h++)for(var f=0;f<d.width;f++){var g=4*(h*d.width+f);255===d.data[g]&&255===d.data[g+1]&&255===d.data[g+2]&&255===d.data[g+3]?(u[g]=l.data[g],u[g+1]=l.data[g+1],u[g+2]=l.data[g+2],u[g+3]=l.data[g+3]):(u[g]=d.data[g],u[g+1]=d.data[g+1],u[g+2]=d.data[g+2],u[g+3]=d.data[g+3])}var v=new ImageData(u,d.width,d.height);o.width=v.width,o.height=v.height,o.getContext("2d").putImageData(v,0,0)})),requestAnimationFrame((function(){return e.drawVideoCanvas()}))},e}return Object(R.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=(this.props,this.props,I().then((function(t){if(null!==t)return e.state.localVideoWidth=t.getVideoTracks()[0].getSettings().width?t.getVideoTracks()[0].getSettings().width:0,e.state.localVideoHeight=t.getVideoTracks()[0].getSettings().height?t.getVideoTracks()[0].getSettings().height:0,console.log("getVideoTrack",e.state.localVideoWidth,e.state.localVideoHeight),e.localVideoRef.current.srcObject=t,e.state.inputVideoStream=t,new Promise((function(t,a){e.localVideoRef.current.onloadedmetadata=function(){t()}}))}))),a=C.b();Promise.all([a,t]).then((function(t){var a=Object(V.a)(t,2),n=a[0];a[1];e.bodyPix=n,requestAnimationFrame((function(){return e.drawVideoCanvas()}))})).catch((function(e){console.error("not find... ",e)}))}},{key:"render",value:function(){return n.createElement("div",{style:{width:"100%",margin:"auto"}},n.createElement("video",{ref:this.localVideoRef,style:{display:"None"},autoPlay:!0}),n.createElement("canvas",{ref:this.localVideoCanvasRef,style:{display:"None"},width:"100%",height:"100%"}),n.createElement("canvas",{ref:this.localVideoMaskCanvasRef,width:"100%",height:"100%",style:{display:"None"}}),n.createElement("canvas",{ref:this.localVideoMaskCanvasRef2,width:"100%",height:"100%",style:{display:"block"}}),n.createElement("img",{ref:this.localVideoMaskBackgroundRef,src:this.state.virtualBackground,style:{display:"None"}}),n.createElement("canvas",{ref:this.localVideoMaskBGCanvasRef,style:{display:"None"}}))}}]),a}(n.Component);var j=Object(d.b)((function(e){return e}),(function(e){return{initialize:function(t){e(m.initialize(t))}}}))(M),O=Object(s.a)(),A=Object(c.d)(v,Object(c.a)(O));O.run(f),r.a.render(i.a.createElement(d.a,{store:A},i.a.createElement(j,null)),document.getElementById("root"))}},[[27,1,2]]]);