(this["webpackJsonpvirtual-background-demo"]=this["webpackJsonpvirtual-background-demo"]||[]).push([[0],{137:function(e,t,a){e.exports=a(262)},262:function(e,t,a){"use strict";a.r(t);var o=a(0),n=a.n(o),r=a(20),i=a.n(r),l=a(28),c=a(51),s=a(126),f=a(25),u=a.n(f),d=u.a.mark(m);function m(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),d)}var g,h,E={counter:0},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=(arguments.length>1&&arguments[1],Object.assign({},e));return t.counter++,t},v=a(269),V=Object(v.a)({INITIALIZE:function(e){return e}}),b=a(75),w=a(116),C=a(117),R=a(128),k=a(127),y=a(16),S=a(268),B=a(78);!function(e){e[e.Full=0]="Full",e[e.Large=1]="Large",e[e.Small=2]="Small"}(g||(g={})),function(e){e[e.BottomLeft=0]="BottomLeft",e[e.BottomRight=1]="BottomRight"}(h||(h={}));var I=function(e){Object(R.a)(a,e);var t=Object(k.a)(a);function a(){var e;Object(w.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={foregroundSizeChange:!1,foregroundSize:g.Full,foregroundPosition:h.BottomRight},e.localCanvasRef=o.createRef(),e.localVideoRef=o.createRef(),e.localVideoEffectors=null,e.fileInputRef=o.createRef(),e.shareVideoElementRef=o.createRef(),e.monitorCanvasRef=o.createRef(),e.isIPhone=!1,e.imageCapture=void 0,e.virtualBGImage=document.createElement("img"),e.enter=0,e.exit=0,e.drawVideoCanvas=Object(b.a)(u.a.mark((function t(){var a,o,n,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.enter=performance.now(),a=e.enter-e.exit,a.toFixed(3),o=performance.now(),null!==e.localCanvasRef.current&&(480,n=480/e.localCanvasRef.current.width*e.localCanvasRef.current.height,e.localVideoEffectors.doEffect(480,n),0!==e.localVideoEffectors.outputWidth&&0!==e.localVideoEffectors.outputHeight&&(e.localCanvasRef.current.height=e.localCanvasRef.current.width/e.localVideoEffectors.outputWidth*e.localVideoEffectors.outputHeight,e.localCanvasRef.current.getContext("2d").drawImage(e.localVideoEffectors.outputCanvas,0,0,e.localCanvasRef.current.width,e.localCanvasRef.current.height))),r=performance.now(),(r-o).toFixed(3),e.exit=performance.now(),requestAnimationFrame((function(){return e.drawVideoCanvas()}));case 10:case"end":return t.stop()}}),t)}))),e.unsetBGImage=function(){e.localVideoEffectors.virtualBackgroundEnabled=!1},e.setBGImage=function(){e.localVideoEffectors.virtualBackgroundEnabled=!0,e.localVideoEffectors.virtualBackgroundImageElement=e.virtualBGImage,e.setState({foregroundSizeChange:!0}),e.shareVideoElementRef.current.pause()},e.sharedDisplaySelected=function(){e.localVideoEffectors.virtualBackgroundEnabled=!0,navigator.mediaDevices.getDisplayMedia().then((function(t){e.localVideoEffectors.virtualBackgroundStream=t,e.setState({foregroundSizeChange:!0}),e.shareVideoElementRef.current.pause()}))},e.sharedVideoSelected=function(t){e.localVideoEffectors.virtualBackgroundEnabled=!0;var a=URL.createObjectURL(t.target.files[0]);console.log(a),e.shareVideoElementRef.current.src=a,e.shareVideoElementRef.current.play(),setTimeout(Object(b.a)(u.a.mark((function t(){var a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.shareVideoElementRef.current.captureStream();case 2:a=t.sent,e.localVideoEffectors.virtualBackgroundStream=a,e.setState({foregroundSizeChange:!0});case 5:case"end":return t.stop()}}),t)}))),3e3)},e.media=null,e}return Object(C.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location.href).searchParams.get("model"),a=new URL(window.location.href).searchParams.get("blur"),o=0;this.localVideoEffectors="MobileNetV1"===t?new y.LocalVideoEffectors(y.ModelConfigMobileNetV1):"MobileNetV1_05"===t?new y.LocalVideoEffectors(y.ModelConfigMobileNetV1_05):"ResNet"===t?new y.LocalVideoEffectors(y.ModelConfigResNet):new y.LocalVideoEffectors(null),o=null===a?0:parseInt(a),this.localVideoEffectors.cameraEnabled=!0,this.localVideoEffectors.virtualBackgroundEnabled=!1,this.virtualBGImage.src="./resources/vbg/pic1.jpg",this.localVideoEffectors.virtualBackgroundImageElement=this.virtualBGImage,this.localVideoEffectors.maskBlurAmount=o,this.localVideoEffectors.monitorCanvas=this.monitorCanvasRef.current,this.localVideoEffectors.selectInputVideoDevice("").then((function(){e.media=e.localVideoEffectors.getMediaStream(),requestAnimationFrame((function(){return e.drawVideoCanvas()}))}))}},{key:"render",value:function(){var e=this;if(navigator.userAgent.indexOf("iPhone")>=0&&(this.isIPhone=!0),!1===this.isIPhone){var t;if(this.state.foregroundSize===g.Full)null===(t=this.localVideoEffectors)||void 0===t||t.setForegroundPosition(0,0,1,1);else if(this.state.foregroundSize===g.Large){var a,n;if(this.state.foregroundPosition===h.BottomLeft)null===(a=this.localVideoEffectors)||void 0===a||a.setForegroundPosition(0,.4,.6,.6);else null===(n=this.localVideoEffectors)||void 0===n||n.setForegroundPosition(.4,.4,.6,.6)}else if(this.state.foregroundSize===g.Small){var r,i;if(this.state.foregroundPosition===h.BottomLeft)null===(r=this.localVideoEffectors)||void 0===r||r.setForegroundPosition(0,.7,.3,.3);else null===(i=this.localVideoEffectors)||void 0===i||i.setForegroundPosition(.7,.7,.3,.3)}return o.createElement("div",{style:{width:"1280px",margin:"auto"}},o.createElement("video",{ref:this.shareVideoElementRef,width:"1280px",style:{display:"none",width:"1280px",margin:"auto"},playsInline:!0}),o.createElement("canvas",{ref:this.localCanvasRef,width:"1280px",style:{display:"block",width:"1280px",margin:"auto"}}),o.createElement("div",{style:{paddingLeft:"10px"}},o.createElement(S.a,{as:"a",onClick:function(){e.unsetBGImage()}},o.createElement(B.a,{name:"share square outline",size:"large"}),"NoVBG"),o.createElement(S.a,{as:"a",onClick:function(){e.setBGImage()}},o.createElement(B.a,{name:"image outline",size:"large"}),"Image"),o.createElement(S.a,{as:"a",onClick:function(){e.sharedDisplaySelected()}},o.createElement(B.a,{name:"share square outline",size:"large"}),"screen"),o.createElement(S.a,{as:"a",onClick:function(){return e.fileInputRef.current.click()}},o.createElement(B.a,{name:"play",size:"large"}),"movie"),o.createElement("input",{ref:this.fileInputRef,type:"file",hidden:!0,onChange:function(t){return e.sharedVideoSelected(t)}}),o.createElement(S.a,{as:"a",onClick:function(){e.localVideoEffectors.foregroundType=y.ForegroundType.NONE}},o.createElement(B.a,{name:"chess board",size:"large"}),"none"),o.createElement(S.a,{as:"a",onClick:function(){e.localVideoEffectors.foregroundType=y.ForegroundType.Canny}},o.createElement(B.a,{name:"chess board",size:"large"}),"canny"),o.createElement(S.a,{as:"a",onClick:function(){e.localVideoEffectors.foregroundType=y.ForegroundType.Ascii}},o.createElement(B.a,{name:"chess board",size:"large"}),"ascii")),o.createElement("div",{style:{paddingLeft:"10px"}},o.createElement(B.a,{basic:!0,link:!0,name:"long arrow alternate left",size:"large",onClick:function(){e.setState({foregroundPosition:h.BottomLeft})}}),o.createElement(B.a,{basic:!0,link:!0,name:"long arrow alternate right",size:"large",onClick:function(){e.setState({foregroundPosition:h.BottomRight})}}),o.createElement(B.a,{basic:!0,link:!0,name:"square outline",size:"large",onClick:function(){e.setState({foregroundSize:g.Full})}}),o.createElement(B.a,{basic:!0,link:!0,name:"expand",size:"large",onClick:function(){e.setState({foregroundSize:g.Large})}}),o.createElement(B.a,{basic:!0,link:!0,name:"compress",size:"large",onClick:function(){e.setState({foregroundSize:g.Small})}})),o.createElement("div",null,o.createElement("a",{href:"https://github.com/FLECT-DEV-TEAM/LocalVideoEffector#readme"},"github"),o.createElement("br",null),o.createElement("a",{href:"https://www.npmjs.com/package/local-video-effector"},"npm")))}return o.createElement("div",{style:{width:"720px",margin:"auto"}},o.createElement("video",{ref:this.localVideoRef,style:{display:"block",width:"720px",margin:"auto"},playsInline:!0}),o.createElement("canvas",{ref:this.localCanvasRef,style:{display:"block",width:"720px",margin:"auto"}}),o.createElement("input",{type:"button",value:"start",onClick:function(t){navigator.mediaDevices.getUserMedia({audio:!1,video:{width:{ideal:1280},height:{ideal:720}}}).then((function(t){if(null!==t)return e.localVideoRef.current.srcObject=t,e.localVideoRef.current.play(),new Promise((function(t,a){e.localVideoRef.current.onloadedmetadata=function(){t()}}))})),e.localVideoEffectors.setVideoElement(e.localVideoRef.current)}}),o.createElement("div",null,o.createElement("a",{href:"https://github.com/FLECT-DEV-TEAM/LocalVideoEffector#readme"},"github"),o.createElement("br",null),o.createElement("a",{href:"https://www.npmjs.com/package/local-video-effector"},"npm")))}}]),a}(o.Component);var z=Object(c.b)((function(e){return e}),(function(e){return{initialize:function(t){e(V.initialize(t))}}}))(I),L=Object(s.a)(),x=Object(l.d)(p,Object(l.a)(L));L.run(m),i.a.render(n.a.createElement(c.a,{store:x},n.a.createElement(z,null)),document.getElementById("root"))}},[[137,1,2]]]);